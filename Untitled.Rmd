---
title: "hw6"
author: "Jiabei Wang"
date: "2018???11???18???"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(rvest)
library(purrr)
knitr::opts_chunk$set(echo = TRUE)
```

problem1
```{r}
city_homicides = read_csv(file = "./homicide-data.csv") %>%
  filter(!(city == "Dallas"| city == "Phoenix"| city == "Kansas City")) %>%
mutate(city_state = paste(city, state)) %>%
  mutate(resolved = as.numeric(disposition == "Closed by arrest"),
         victim_age = as.numeric(victim_age)) %>%
mutate(victim_race = ifelse(victim_race == "White", "White", "nonwhite"))
         
```

```{r}
baltimore = city_homicides %>%
  filter(city_state =="Baltimore MD")

fit_logistic = baltimore %>%
  glm(resolved ~victim_age + victim_sex + victim_race, data = ., family = binomial()) 

Result_Stats =   
  fit_logistic%>%
broom::tidy() %>%
mutate(OR = exp(estimate)) %>%
  select(term, log_OR = estimate, OR, p.value) %>% 
  knitr::kable(digits = 3)
```

```{r}
city_data = city_homicides %>%
  group_by(city_state)


```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
